<!-- Copyright: Aaron Christophel / Atc1441 https://atcnetz.de --><html class="telFlasherClass"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartHub</title>
    <script src="/smarthub.2fd0bd96.js"></script>
</head>

<body>
    <button type="button" onclick="connect();">Connect</button>
    <button type="button" onclick="reConnect();">Reconnect</button><br>
    <div style="display: none"><big><big>Telink Flasher for Mi Thermostat</big></big><br>
    Copyright: Aaron Christophel / Atc1441 <a href="https://atcnetz.de">https://ATCnetz.de</a><br>
    <a href="https://youtu.be/NXKzFG61lNs">Video Manual</a> <a href="https://github.com/atc1441/ATC_MiThermometer">Custom firmware repo</a><br><br>
    <label for="hideUnknown">Hide unknown</label>
    <input type="checkbox" id="hideUnknown"><br>
    <label for="namePrefix">BLE device name prefix filter(s)</label>
    <input type="text" id="namePrefix" value="" placeholder="LYWSD03,ATC"><br>
    <button type="button" onclick="sendRegister();">Do Activation</button>
    <button type="button" onclick="sendLogin();">Do via Login</button>
    <button type="button" onclick="startDFU();">Start Flashing</button>
    <button type="button" onclick="clearLog();">Clear Log</button><br><br>
    Please select a .bin file you want to flash to a Telink BLE device.<br><br>
    Select Firmware: <input type="file" accept=".bin" id="file" onclick="resetFileSelector();"><br>
    <div id="percent">Status: waiting for you to connect a device</div>
    <hr>
    <hr></div>

    <div id="tempHumiData" style="color: #00f; font-size: 3em">Temp/Humi: waiting for data</div>
    <label for="tempThreshold">Warning temperature: </label><input type="text" placeholder="tempThreshold" id="tempThreshold" value="21"><br>
    <label for="notificationEmail">Email: </label><input type="email" id="notificationEmail"><br>
    <label for="notificationSchedule">Send on schedule: </label><input type="checkbox" id="notificationSchedule"><br>
    <label for="emailAPIService">Email sender API service: </label><input type="text" id="emailAPIService"><br>
    <label for="emailAPITemplate">Email sender API template: </label><input type="text" id="emailAPITemplate"><br>
    <label for="emailAPIKey">Email sender API token: </label><input type="text" id="emailAPIKey">


<div style="display: none">  
    <div id="MAC">#enable-experimental-web-platform-features may be needed to read MAC</div>
    <hr>
    Device known id:<br>
    <input size="40" type="text" id="known_id" value=""><br>
    Mi Token:<br>
    <input size="40" type="text" id="mi_token" value=""><br>
    Mi Bind Key:<br>
    <input size="40" type="text" id="mi_bind_key" value=""><br>
    <br>
    When doing an activation here the device is needed to be activated in the Mi app again when wanted to use there.
    <hr>
    Send settings to custom firmware:<br>
    <input type="text" id="cmdTXT" value="">
    <button type="button" onclick="sendCustomSetting(document.getElementById(&quot;cmdTXT&quot;).value,settingsCharacteristics);">Send</button>
    <br><br>
    Settings:
    <button type="button" onclick="sendCustomSetting(&quot;DF&quot;);">Save current settings in flash</button>
    <button type="button" onclick="sendCustomSetting(&quot;DE&quot;);">Reset settings to default</button>
    <br><br>
    Smiley:
    <button type="button" onclick="sendCustomSetting(&quot;A0&quot;);">Off</button>
    <button type="button" onclick="sendCustomSetting(&quot;A1&quot;);">Happy</button>
    <button type="button" onclick="sendCustomSetting(&quot;A2&quot;);">Sad</button>
    <button type="button" onclick="sendCustomSetting(&quot;AB&quot;);">Blinking</button>
    <button type="button" onclick="sendCustomSetting(&quot;A3&quot;);">Comfort Indicator</button>
    <br><br>
    Advertising Type:
    <button type="button" onclick="sendCustomSetting(&quot;AE&quot;);">Custom</button>
    <button type="button" onclick="sendCustomSetting(&quot;AF&quot;);">Mi Like</button>
    <br><br>
    Sensor display:
    <button type="button" onclick="sendCustomSetting(&quot;CC&quot;);">In °C</button>
    <button type="button" onclick="sendCustomSetting(&quot;FF&quot;);">In °F</button>
    <br><br>
    Sensor advertising:
    <button type="button" onclick="sendCustomSetting(&quot;0C&quot;);">In °C</button>
    <button type="button" onclick="sendCustomSetting(&quot;0F&quot;);">In °F</button>
    <br><br>
    Show battery in LCD:
    <button type="button" onclick="sendCustomSetting(&quot;B1&quot;);">Enabled</button>
    <button type="button" onclick="sendCustomSetting(&quot;B0&quot;);">Disabled</button>
    <br><br>
    Advertising interval:
    <button type="button" onclick="sendCustomSetting(&quot;FE01&quot;);">10 Seconds</button>
    <button type="button" onclick="sendCustomSetting(&quot;FE06&quot;);">1 Minute</button>
    <button type="button" onclick="sendCustomSetting(&quot;FE1E&quot;);">5 Minutes</button>
    <button type="button" onclick="sendCustomSetting(&quot;FE3C&quot;);">10 Minutes</button>
    <br><br>
    Sensor offset:
    <button type="button" onclick="sendCustomSetting(&quot;FA00&quot;);">Temp 0°C offset</button>
    <button type="button" onclick="sendCustomSetting(&quot;FB00&quot;);">Humi 0% offset</button><br>
    To set a precise offset use the text input field with FA+offset for Temp and FB+offset for Humiditiy convert an int8
    to hex.
    <br><br>
    Sensor instant Advertising:
    <button type="button" onclick="sendCustomSetting(&quot;FC05&quot;);">Temp 0,5°C instant alarm</button>
    <button type="button" onclick="sendCustomSetting(&quot;FD05&quot;);">Humi 5% instant alarm</button><br>
    To set other values use the text input with FC+temp alarm or FD+humi alarm with uint8_t values.
    This can be used to get instant advertising if the sensor data changes to fast. Temp divided by 10
    <br>
    To set a precise offset use the text input field with FA+offset for Temp and FB+offset for Humiditiy convert an int8
    to hex.
    <br>
    <hr>
    <div id="mapper"><button id="mapper_toggle_button" type="button" onclick="mapper_toggle();">Show LCD Segment
            Mapper</button><br>

        <div style="display: none" id="mapper_content">

            <div>
                Byte0:
                <input type="checkbox" id="check00">0
                <input type="checkbox" id="check01">1
                <input type="checkbox" id="check02">2
                <input type="checkbox" id="check03">3
                <input type="checkbox" id="check04">4
                <input type="checkbox" id="check05">5
                <input type="checkbox" id="check06">6
                <input type="checkbox" id="check07">7
            </div>
            <div>
                Byte1:
                <input type="checkbox" id="check10">0
                <input type="checkbox" id="check11">1
                <input type="checkbox" id="check12">2
                <input type="checkbox" id="check13">3
                <input type="checkbox" id="check14">4
                <input type="checkbox" id="check15">5
                <input type="checkbox" id="check16">6
                <input type="checkbox" id="check17">7
            </div>
            <div>
                Byte2:
                <input type="checkbox" id="check20">0
                <input type="checkbox" id="check21">1
                <input type="checkbox" id="check22">2
                <input type="checkbox" id="check23">3
                <input type="checkbox" id="check24">4
                <input type="checkbox" id="check25">5
                <input type="checkbox" id="check26">6
                <input type="checkbox" id="check27">7
            </div>
            <div>
                Byte3:
                <input type="checkbox" id="check30">0
                <input type="checkbox" id="check31">1
                <input type="checkbox" id="check32">2
                <input type="checkbox" id="check33">3
                <input type="checkbox" id="check34">4
                <input type="checkbox" id="check35">5
                <input type="checkbox" id="check36">6
                <input type="checkbox" id="check37">7
            </div>
            <div>
                Byte4:
                <input type="checkbox" id="check40">0
                <input type="checkbox" id="check41">1
                <input type="checkbox" id="check42">2
                <input type="checkbox" id="check43">3
                <input type="checkbox" id="check44">4
                <input type="checkbox" id="check45">5
                <input type="checkbox" id="check46">6
                <input type="checkbox" id="check47">7
            </div>
            <div>
                Byte5:
                <input type="checkbox" id="check50">0
                <input type="checkbox" id="check51">1
                <input type="checkbox" id="check52">2
                <input type="checkbox" id="check53">3
                <input type="checkbox" id="check54">4
                <input type="checkbox" id="check55">5
                <input type="checkbox" id="check56">6
                <input type="checkbox" id="check57">7
            </div>
            <button type="button" onclick="mapper_send()">Send bytes</button><br>
        </div>
    </div></div>     
    <div id="log">Log:<br></div>
    <div id="result"></div>
    
    <script src="/smarthub.01f8a744.js" type="module"></script>



</body></html>